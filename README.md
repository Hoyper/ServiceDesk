## Стэк:

* Python 3.12
* FastApi
* PostgreSQL
* Redis
* Celery
* Celery Beat

## Установка и запуск

### Клонирование репозитория
```
git clone https://github.com/Hoyper/ServiceDesk.git
```

### Создание файла `.env`

Для корректной работы приложения необходимо создать файл `.env` на основе примера из `.env-example`.

### Запуск проекта

Для запуска необходимо из корневой папки проекта использовать команду
```
uvicorn app.api.main:app --reload --port 8007
```

### Документация API
После запуска эндпоинты приложения и документация доступны по адресу:
```
http://127.0.0.1:8007/api/v1/servicedesk/docs
```

### Миграции
После запуска приложения необходимо сделать миграцию бд, для этого нужно последовательно выполнить команды:
```
make migration
```
```
make upgrade
```

### Тестовые данные

Для тестирования приложения вам необходимо загрузить тестовые данные, создав оператора, при помощи эндпоинта:
```
/api/v1/servicedesk/docs
```

### Redis

Также для работы приложения требуется redis, следует запустить redis-server на стандартном порту 6379


### Celery

Для запуска воркеров celery следует использовать команду:
```
celery -A app.core.celery_utils.celery_app worker --loglevel=info --pool=solo
```

Для запуска celery beat следует использовать команду:
```
celery -A app.core.celery_utils.celery_app beat --loglevel=info
```

### Функционал

Далее после настройки можно использовать приложение, для тестовой отправки сообщения можно использовать эндпоинт:
```
/api/v1/users/send_message
```
указав в `to_email` почту вашего оператора

эндпоинт:
```
/api/v1/users/operator_send_message
```
отвечает за отправку сообщений от имени оператора, также можно закрыть ticket воспользовашись эндпоинтом:
```
/api/v1/users/close_ticket
```

эндпоинт:
```
/api/v1/tickets/add_ticket
```
нужен для тестирования и может не использоваться


### Форматеры

Для приведения кода к единому стилю, можно использовать команду:
```
make format
```